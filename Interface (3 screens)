from kivy.app import App
from kivy.lang.builder import Builder
from kivy.uix.screenmanager import Screen
from kivy.core.window import Window
from kivy.uix.screenmanager import ScreenManager
from kivy.uix.screenmanager import ScreenManagerException


class ScreenOne(Screen):
    pass

class ScreenTwo(Screen):
    pass

class ScreenThree(Screen):
    pass

class CustScreenManager(ScreenManager):
    @staticmethod
    def button_click(self):
        if self.background_color == [.88, .88, .88, 1]:
            self.background_color = [0, 1, 0, 1]
        else:
            self.background_color = [.88, .88, .88, 1]

    @staticmethod
    def set_random_speed(self,min_speed,max_speed):
        if self.background_color == [0, 1, 0, 1]:
            min_speed = 60
            max_speed = 120

    @staticmethod
    def no_spin_for_both(self,spin_speed):
        if self.text == "No Spin":
            spin_speed.text = "No Spin"

sm = Builder.load_string("""

<CustButton@Button>:
    color: 0, 0, 0, 1
    background_normal: ''
    background_down: 'bkgrd-down-color.png'
    background_color: .88, .88, .88, 1

<CustLabel@Label>:
    color: 0, 0, 0, 1
    orientation: "vertical"

<CustSpinner@Spinner>:
    color: 0, 0, 0, 1
    background_normal: ''
    background_down: 'bkgrd-down-color.png'
    background_color: .88, .88, .88, 1


CustScreenManager:

    ScreenOne:
        name: "ScreenOne"
        id: ScreenOne
        
        FloatLayout:

            CustButton:
                text: "Custom"
                size_hint: .4, .3
                size: 150, 50
                font_size: 32
                pos_hint: {"center_x": .5, "center_y": .30}
                on_press:
                    root.transition.direction = 'left'
                    root.transition.duration = 0.5
                    root.current = 'ScreenTwo'

            CustButton:
                text: "Random"
                size_hint: .4, .3
                size: 150, 50
                font_size: 32
                pos_hint: {"center_x": .5, "center_y": .70}


    ScreenTwo:
        name: "ScreenTwo"
        id: ScreenTwo
        BoxLayout:
            orientation: "vertical"
            padding: 10

            BoxLayout:
                orientation: "horizontal"
                size_hint_y: None
                height: 60

                CustButton:
                    text: "<= Back"
                    font_size: 25
                    size_hint_x: 0.2
                    on_press:
                        root.transition.direction = 'right'
                        root.transition.duration = 0.5
                        root.current = 'ScreenOne'

                BoxLayout:
                    size_hint_x: 0.6
                    CustLabel:
                        text:"Custom Training"
                        font_size: 50 

                CustButton:
                    text: "Start"
                    font_size: 25
                    size_hint_x: 0.2
                    on_press:
                        root.transition.direction = 'left'
                        root.transition.duration = 0.5
                        root.current = 'ScreenThree'


            BoxLayout:
                orientation: "horizontal"
                spacing: 10

                BoxLayout:
                    orientation: "vertical"
                    size_hint_x: 40

                    CustLabel:
                        text: "Speed"
                        font_size: 40

                    CustButton:
                        text: "Random"
                        font_size: 20
                        on_press:
                            root.button_click(self)
                        on_release:
                            root.set_random_speed(self,minslider_id.value,maxslider_id.value)

                    CustLabel:
                        text: "Min Speed: "+str(minslider_id.value)+"km/h  "
                        font_size: 30

                    Slider:
                        id: minslider_id
                        min: 60
                        max: maxslider_id.value
                        value: 60
                        step: 5

                    CustLabel:
                        text: "Max Speed: "+str(maxslider_id.value)+"km/h  "
                        font_size: 30

                    Slider:
                        id: maxslider_id
                        min: minslider_id.value
                        max: 120
                        value: 120
                        step: 5

                BoxLayout:
                    orientation: "vertical"
                    size_hint_x: 20

                    CustLabel:
                        text: "Spin"
                        font_size: 40

                    CustButton:
                        text: "Random"
                        font_size: 20
                        on_press:
                            root.button_click(self)

                    CustLabel:
                        text: "Direction"
                        font_size: 30

                    CustSpinner:
                        text: "No Spin"
                        font_size: 25
                        values: ["No Spin","Top Spin", "Right Spin", "Left Spin"]
                        id: spinnerrightleft_id

                    CustLabel:
                        text: "Speed"
                        font_size: 30

                    CustSpinner:
                        text: "No Spin"
                        font_size: 25
                        values: ["No Spin", "Slow", "Fast"]
                        id: spinnerspeed_id

                BoxLayout:
                    orientation: "vertical"
                    size_hint_x: 40

                    CustLabel:
                        size_hint_y: 16
                        text: "Area"
                        font_size: 40

                    GridLayout:
                        cols: 3
                        rows: 4
                        size_hint_y: 70
                        spacing: 10

                        CustLabel:
                            size_hint_x: 1
                        CustButton:
                            text: "Random"
                            font_size: 20
                            size_hint_x: 1
                            on_press:
                                root.button_click(self)
                        CustLabel:
                            size_hint_x: 1
                        CustButton:
                            text: "1"
                            id: button1
                            size_hint_x: 1
                            on_press:
                                root.button_click(self)
                        CustLabel:
                            size_hint_x: 1
                        CustButton:
                            text: "2"
                            id: button2
                            size_hint_x: 1
                            on_press:
                                root.button_click(self)
                        CustButton:
                            text: "3"
                            id: button3
                            size_hint_x: 1
                            on_press:
                                root.button_click(self)
                        CustLabel:
                            size_hint_x: 1
                        CustButton:
                            text: "4"
                            id: button4
                            size_hint_x: 1
                            on_press:
                                root.button_click(self)
                        CustButton:
                            text: "5"
                            id: button5
                            size_hint_x: 1
                            on_press:
                                root.button_click(self)
                        CustButton:
                            text: "6"
                            id: button6
                            size_hint_x: 1
                            on_press:
                                root.button_click(self)
                        CustButton:
                            text: "7"
                            id: button7
                            size_hint_x: 1
                            on_press:
                                root.button_click(self)
                    CustLabel:
                        size_hint_y: 14

    ScreenThree:
        name: "ScreenThree"
        id: ScreenThree
        BoxLayout:
            orientation: "vertical"
            padding: 10

            BoxLayout:
                orientation: "horizontal"
                size_hint_y: None
                height: 60

                CustButton:
                    text: "<= Back"
                    font_size: 25
                    size_hint_x: 0.2
                    on_press:
                        root.transition.direction = 'right'
                        root.transition.duration = 0.5
                        root.current = 'ScreenTwo'

                BoxLayout:
                    size_hint_x: 0.6
                    CustLabel:
                        text:"Custom Training"
                        font_size: 50 

                CustButton:
                    text: "Start"
                    font_size: 25
                    size_hint_x: 0.2
                    on_press:
                        root.transition.direction = 'left'
                        root.transition.duration = 0.5
                        root.current = 'ScreenFour'

            BoxLayout:
                orientation: "horizontal"
                spacing: 10
                size_hint_y: 0.85

                BoxLayout:
                    orientation: "vertical"
                    size_hint_x: 40

                    CustLabel:
                        text: "Speed"
                        font_size: 40

                    CustLabel:
                        text: "Min Speed: "+str(minslider_id.value)+"km/h  "
                        font_size: 30

                    CustLabel:
                        text: "Max Speed: "+str(maxslider_id.value)+"km/h  "
                        font_size: 30

                BoxLayout:
                    orientation: "vertical"
                    size_hint_x: 20

                    CustLabel:
                        text: "Spin"
                        font_size: 40

                    CustLabel:
                        text: "Direction\\n" + spinnerrightleft_id.text
                        font_size: 30

                    CustLabel:
                        text: "Speed\\n" + spinnerspeed_id.text
                        font_size: 30

                BoxLayout:
                    orientation: "vertical"
                    size_hint_x: 40

                    CustLabel:
                        size_hint_y: 6

                    CustLabel:
                        size_hint_y: 20
                        text: "Area"
                        font_size: 40

                    GridLayout:
                        cols: 3
                        rows: 3
                        size_hint_y: 74
                        spacing: 10

                        CustLabel:
                            font_size: 25
                            text: "1"
                            color: button1.background_color
                            size_hint_x: 1
                        CustLabel:
                            size_hint_x: 1
                        CustLabel:
                            font_size: 30
                            text: "2"
                            color: button2.background_color
                            size_hint_x: 1
                        CustLabel:
                            text: "3"
                            font_size: 30
                            color: button3.background_color
                            size_hint_x: 1
                        CustLabel:
                            size_hint_x: 1
                        CustLabel:
                            text: "4"
                            font_size: 30
                            color: button4.background_color
                            size_hint_x: 1
                        CustLabel:
                            text: "5"
                            font_size: 30
                            color: button5.background_color
                            size_hint_x: 1
                        CustLabel:
                            text: "6"
                            font_size: 30
                            color: button6.background_color
                            size_hint_x: 1
                        CustLabel:
                            text: "7"
                            font_size: 30
                            color: button7.background_color
                            size_hint_x: 1
                
            BoxLayout:
                orientation: "horizontal"
                size_hint_y: 0.15

                CustLabel:
                    size_hint_x: 0.3
                    text: "Pace: " + str(pace_slider_id.value) + "s"
                    font_size: 30
                    
                Slider:
                    size_hint_x: 0.4
                    id: pace_slider_id
                    min: 1
                    max: 10
                    step: 1

                CustButton:
                    size_hint_x: 0.3
                    text: "Manual"
                    font_size: 25
                    on_press:
                        root.button_click(self)
                    
""")

class TestApp(App):

    def build(self):
        Window.clearcolor = (1, 1, 1, 1)
        return sm

TestApp().run()
